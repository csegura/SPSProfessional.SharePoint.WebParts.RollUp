<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<?xml-stylesheet type="text/xsl" href="to_html.xslt"?><page>
  <title>SPSRollUp WebPart</title>
  <titleorder>A</titleorder>
  <description />
  <content>&lt;p&gt;With the &lt;b&gt;SPSProfessional &lt;/b&gt;RollUp WebPart you can aggregate contents from different lists and sites. &lt;/p&gt; &lt;p&gt;The &lt;b&gt;SPSRollUp&lt;/b&gt; webpart is based in the well known &lt;b&gt;csegRollUp&lt;/b&gt; of &lt;a href="http://www.ideseg.com/CategoryView,category,csegRollUp.aspx"&gt;Carlos Segura&lt;/a&gt; that is undoubtedly one of the most used webparts for SharePoint 2003. &lt;/p&gt; &lt;p&gt;With SPSRollUp you can aggregate incoming content from various lists. To do this you only have to specify the site from which you want to crawl data, your wish lists and the fields’ names.&lt;br&gt;&lt;/p&gt; &lt;p style="text-align: center"&gt;&lt;img alt="" src="images/products/SPSRollUp_Images7.gif"&gt; &lt;/p&gt; &lt;p&gt;The &lt;strong&gt;SPSProfessional&lt;/strong&gt; RollUp, crawls every site and adds the lists and fields’ contents.&lt;/p&gt; &lt;h3&gt;Installation&lt;/h3&gt; &lt;p&gt;See: &lt;strong&gt;&lt;a href="/page/install-spsprofessional-sharepoint-solutions.aspx"&gt;Install SPSProfessional Solutions&lt;/a&gt;&lt;/strong&gt; &lt;/p&gt; &lt;h3&gt;Installation Requirements&lt;/h3&gt; &lt;ul&gt; &lt;li&gt;The &lt;strong&gt;SPSProfessional&lt;/strong&gt; RollUp WebPart performs in &lt;strong&gt;&lt;span class="caps"&gt;WSS 3&lt;/span&gt;&lt;/strong&gt; and or &lt;strong&gt;&lt;span class="caps"&gt;MOSS 2007&lt;/span&gt;&lt;/strong&gt;  &lt;li&gt;&lt;strong&gt;&lt;font color="#404040"&gt;SharePoint &lt;/font&gt;&lt;/strong&gt;Administrator’s Account is needed to install the solution &lt;/li&gt;&lt;/ul&gt; &lt;h2&gt;WebPart Properties&lt;/h2&gt; &lt;p style="float: right; margin-left: 15px"&gt;&lt;img height="398" alt="" src="images/products/SPSRollUp_Images4.gif" width="222"&gt; &lt;/p&gt; &lt;p&gt;In the webpart properties you can configure: &lt;/p&gt; &lt;p&gt;&lt;b&gt;Top Site:&lt;/b&gt; Site where the aggregation begins, if the Top Site property is empty the RollUp will begin at the current web level&lt;/p&gt; &lt;p&gt;&lt;b&gt;Lists:&lt;/b&gt; List names, you can specify more than one list, separating the lists names with a comma.&lt;/p&gt; &lt;p&gt;&lt;b&gt;Fields:&lt;/b&gt; Field names that you want to add, separating each field’s name with a comma.&lt;/p&gt; &lt;p&gt;&lt;b&gt;CAML query:&lt;/b&gt; You can specify here a CAML query where the rollup will be used to obtain data from each list. If there is no query it will mean that all lists’ data have been used. &lt;/p&gt; &lt;p&gt;&lt;b&gt;XSLT:&lt;/b&gt; The XML Style sheet is used to transform the XML into HTML. It is Included in the package. There are three XSL Samples.  &lt;ul&gt; &lt;li&gt;Generic Table sample  &lt;li&gt;Generic Table with Paging sample  &lt;li&gt;Generic Table with Paging and Sorting &lt;/li&gt;&lt;/ul&gt; &lt;p&gt;&lt;a href="/page/SPSRollUp-Sample-Templates.aspx"&gt;&lt;strong&gt;See Sample Templates included in the solution package&lt;/strong&gt;&lt;/a&gt; &lt;/p&gt; &lt;p&gt;&lt;b&gt;Recursive CAML:&lt;/b&gt; If the CAML recursive query is checked the query will be in recursive form.  &lt;p&gt;&lt;b&gt;Included List Data:&lt;/b&gt; If it is checked, the rollup will add some extra fields to the results  &lt;ul&gt; &lt;li&gt;&amp;lt;_ListTitle/&amp;gt; List title  &lt;li&gt;&amp;lt;_ListUrl/&amp;gt; Url the default view  &lt;li&gt;&amp;lt;_SiteTitle/&amp;gt; Site title  &lt;li&gt;&amp;lt;_SiteUrl/&amp;gt; Site Url  &lt;li&gt;&amp;lt;_ItemID/&amp;gt; Item ID  &lt;li&gt;&amp;lt;_ItemUrl/&amp;gt; Item Url  &lt;li&gt;&amp;lt;_ItemEdit/&amp;gt; Edit Item Page  &lt;li&gt;&amp;lt;_RowNumber/&amp;gt; Row number in the set &lt;/li&gt;&lt;/ul&gt; &lt;p&gt;&lt;b&gt;Debug XML Results:&lt;/b&gt; If the SPSRollUp is checked it will show the XML crawled results so you can use this to test the XSL.  &lt;p style="text-align: center"&gt;&lt;img height="244" alt="" src="images/products/SPSRollUp_Images1.gif" width="482"&gt; &lt;/p&gt; &lt;p&gt;&lt;b&gt;Debug CAML Query:&lt;/b&gt; If it is checked the SPSRollUp will show the original CAML query and the processed one that is the one in which the functions are substituted with your values.  &lt;p style="text-align: center"&gt;&lt;img height="329" alt="" src="images/products/SPSRollUp_Images2.gif" width="282"&gt; &lt;/p&gt; &lt;p&gt;&lt;b&gt;Show Sample Functions:&lt;/b&gt; If it is checked the SPSRollUp will show an example table with a set of custom functions that you can use in the CAML queries and in the current values. (see:&lt;strong&gt; &lt;/strong&gt;&lt;strong&gt;&lt;a href="/page/SPSRollUp-CAML-Functions.aspx"&gt;Functions&lt;/a&gt;&lt;/strong&gt;) &lt;/p&gt; &lt;p&gt;Inside the CAML Queries you can use a set of custom functions made by &lt;strong&gt;SPSProfessional&lt;/strong&gt;; these functions have the next format:  &lt;p&gt;&lt;code&gt;[&amp;lt;Variable Name&amp;gt;:&amp;lt;Function(&amp;lt;arguments&amp;gt;)&amp;gt; or &amp;lt;Default value&amp;gt;]&lt;/code&gt; &lt;/p&gt; &lt;p&gt;Variable name, it is the name of a variable for example “MyDate”, in this function you can use one of the &lt;strong&gt;SPSProfessional&lt;/strong&gt; custom functions as &lt;i&gt;DateFormat(’s’)&lt;/i&gt; that returns the current date time in a shorter format.  &lt;p&gt;Then the correct syntax which you can use inside the query and it will be &lt;em&gt;[Date:DateFormat(‘s’)]&lt;/em&gt;&lt;/p&gt;&lt;pre&gt;&lt;span style="color: #0000ff"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: #800000"&gt;Where&lt;/span&gt;&lt;span style="color: #0000ff"&gt;&amp;gt;&lt;/span&gt; 
&lt;span style="color: #0000ff"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: #800000"&gt;Eq&lt;/span&gt;&lt;span style="color: #0000ff"&gt;&amp;gt;&lt;/span&gt; 
&lt;span style="color: #0000ff"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: #800000"&gt;FieldRef&lt;/span&gt; &lt;span style="color: #ff0000"&gt;Name&lt;/span&gt;=&lt;span style="color: #0000ff"&gt;"StartDate"&lt;/span&gt; &lt;span style="color: #0000ff"&gt;/&amp;gt;&lt;/span&gt; 
&lt;span style="color: #0000ff"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: #800000"&gt;Value&lt;/span&gt; &lt;span style="color: #ff0000"&gt;Type&lt;/span&gt;=&lt;span style="color: #0000ff"&gt;"Text"&lt;/span&gt;&lt;span style="color: #0000ff"&gt;&amp;gt;&lt;/span&gt;[Date:DateFormat('s')]&lt;span style="color: #0000ff"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: #800000"&gt;Value&lt;/span&gt;&lt;span style="color: #0000ff"&gt;&amp;gt;&lt;/span&gt; 
&lt;span style="color: #0000ff"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: #800000"&gt;Eq&lt;/span&gt;&lt;span style="color: #0000ff"&gt;&amp;gt;&lt;/span&gt;
&lt;span style="color: #0000ff"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: #800000"&gt;Where&lt;/span&gt;&lt;span style="color: #0000ff"&gt;&amp;gt;&lt;/span&gt; 
&lt;/pre&gt;&lt;pre&gt;&lt;span style="color: #0000ff"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: #800000"&gt;Where&lt;/span&gt;&lt;span style="color: #0000ff"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;This &lt;span class="caps"&gt;CAML&lt;/span&gt; query must return the items that match the condition where StartDate is equal to current date time. &lt;/p&gt;
&lt;p&gt;For a complete list of functions see: &lt;a href="/page/SPSRollUp-CAML-Functions.aspx"&gt;&lt;strong&gt;Functions&lt;/strong&gt;&lt;/a&gt; &lt;/p&gt;
&lt;p&gt;Also this is a form to introduce a variable in the query. The variable has the function value as a default. 
&lt;p&gt;We can connect the rollup with other webparts in order to receive a value for this variable. If the value is provided by other webparts, the new value will be the value used. 
&lt;p style="text-align: center"&gt;&lt;img height="41" alt="" src="images/products/SPSRollUp_Images6.gif" width="358"&gt; &lt;/p&gt;
&lt;p&gt;Also we have provided the XSLT with a special namespace, this namespace counts with some special functions that we will expand in successive versions. Here they are the ones we already have: 
&lt;p&gt;&lt;code&gt;sps:Event(action, parameters) and sps:EventJS(action, parameters) &lt;/code&gt;&lt;/p&gt;
&lt;p&gt;You can use ‘Select’ as an action, to send a Row of data to a consumer’s webpart, the parameter must contain the record number to be able to be sent to the consumer webpart. Each row crawled by the SPSRollUp has a _RowNumber element, as an unique identifier inside the results. 
&lt;p&gt;Other action is Page, that will be used by the sample templates to change pages, and Order them and also will be used by the sample templates to sort the results. 
&lt;p&gt;You can use this snippet to select and provide a record &lt;/p&gt;&lt;pre&gt;&lt;span style="color: #0000ff"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: #800000"&gt;a&lt;/span&gt; &lt;span style="color: #ff0000"&gt;href&lt;/span&gt;=&lt;span style="color: #0000ff"&gt;"{sps:Event('Select',_RowNumber)}"&lt;/span&gt;&lt;span style="color: #0000ff"&gt;&amp;gt;&lt;/span&gt;
   &lt;span style="color: #0000ff"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color: #800000"&gt;img&lt;/span&gt; &lt;span style="color: #ff0000"&gt;src&lt;/span&gt;=&lt;span style="color: #0000ff"&gt;"/_layouts/images/exptitem.gif"&lt;/span&gt; &lt;span style="color: #ff0000"&gt;border&lt;/span&gt;=&lt;span style="color: #0000ff"&gt;"0"&lt;/span&gt; &lt;span style="color: #0000ff"&gt;/&amp;gt;&lt;/span&gt;
&lt;span style="color: #0000ff"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="color: #800000"&gt;a&lt;/span&gt;&lt;span style="color: #0000ff"&gt;&amp;gt;&lt;/span&gt;&lt;/pre&gt;
&lt;p&gt;Then when the XML data is transformed into HTML with the XSLT, the custom’s function sps:Event is replaced by a JavaScript function that will be responsible for sending the record’s data via the provider’s interface. 
&lt;p&gt;For more functions on the sps namespace see &lt;a href="/page/SPS-Namespace-Functions.aspx"&gt;&lt;strong&gt;SPS Namespace functions&lt;/strong&gt;&lt;/a&gt; &lt;/p&gt;
&lt;p&gt;SPSRollUp can act as a consumer, receiving data to be used in CAML Queries and to be used to send a complete row of data from a provider to other webparts.&amp;nbsp;&amp;nbsp; &lt;p&gt;Included in the package there are three &lt;span class="caps"&gt;XSLT&lt;/span&gt; samples showing how you can do this. &lt;/p&gt;
&lt;h2&gt;Creating a Simple Report&lt;/h2&gt;
&lt;p&gt;&lt;a href="/page/spsrollup-simple-report.aspx"&gt;&lt;strong&gt;Creating a Simple Report&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;</content>
  <keywords />
  <parent>16914384-a763-4eb7-b6b3-cf59c3b532ef</parent>
  <isfrontpage>False</isfrontpage>
  <showinlist>True</showinlist>
  <ispublished>True</ispublished>
  <datecreated>2008-04-06 04:14:19</datecreated>
  <datemodified>2008-05-02 19:06:47</datemodified>
</page>